<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>worlddatr • worlddatr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="worlddatr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">worlddatr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/worlddatr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>worlddatr</h1>
            
      

      <div class="d-none name"><code>worlddatr.Rmd</code></div>
    </div>

    
    
<p><code>worlddatr</code> makes creating choropleth maps easier and
quicker so you can spend more time of your research instead of data
cleaning. Often, you will want to analyse global trends in data, include
metrics such as income level of the country and plot all of this
information on a map of the world. However, these various data sources
use different variables, country names and codes, consequently, the data
is time-consuming and burdensome to use, especially if you are new to
programming langauages such as R. For instance:</p>
<ul>
<li>Various spellings of a country/territory (i.e. North Korea, N.Korea,
Democratic People’s Republic of Korea)</li>
<li>English or native translations, non-ASCII Characters (i.e. Spain,
España)</li>
<li>Different definitions or groupings of countries/territory
(i.e. Channel Islands grouped together, or Jersey, Guernsey etc. listed
separately)</li>
</ul>
<p>Typically, each researcher wanting to plot the globe would need to go
through this data cleaning process, we’ve done this so you don’t have to
and packaged it into an R package, <code>worlddatr</code>. Key features
include:</p>
<ul>
<li>Pre-processed Datasets: Access to pre-cleaned datasets that are
ready to merge with your data, reducing the time spent on data
preparation.</li>
<li>One-command Utilty: Functions that allow you to produce maps with a
single command, while still providing control over customisation options
such as colours, titles, and legends.</li>
<li>Open Source and Community-driven: Being open-source, worlddatr
invites users to build upon its code, tailor visualisations to their
specific needs, and contribute improvements back to IDDO, enhancing the
tool for the entire research community.</li>
</ul>
<div class="section level2">
<h2 id="installing-worlddatr">Installing worlddatr<a class="anchor" aria-label="anchor" href="#installing-worlddatr"></a>
</h2>
<p>You can install the <code>worlddatr</code> package from <a href="https://github.com/Infectious-Diseases-Data-Observatory/worlddatr" class="external-link">GitHub</a>,
there you can find the code required.</p>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>There are two datasets in the package, <code>world_income</code>,
which has a row per country/territory and provides the country ISO
codes, name and income group. This has 250 rows and 7 columns.
<code>alpha_3_code</code>, <code>alpha_2_code</code> and
<code>numeric</code> refer to the ISO standardised country codes,
<code>country</code> and <code>economy</code> list the names of the
country from ISO and World Bank datasets respectively, while
<code>income_group</code> provides the income infomation for each
entity. <code>redcap_number</code> is also included as a classification
number for IDDO REDCap databases, which is an alphabetical, English list
of countries, note this is not standardised so check that you data
matches this list before using the <code>redcap_number</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">world_income</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">#&gt;   alpha_3_code alpha_2_code numeric country   economy income_group redcap_number</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AFG          AF                 4 Afghanis… Afghan… Low income               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> ALB          AL                 8 Albania   Albania Upper middl…             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> DZA          DZ                12 Algeria   Algeria Upper middl…             4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ASM          AS                16 American… Americ… High income              5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> AND          AD                20 Andorra   Andorra High income              6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> AGO          AO                24 Angola    Angola  Lower middl…             7</span></span></code></pre></div>
<p>The second dataset merges the previous <code>world_income</code> with
the <code>ggplot2</code> <code>map_data()</code> function, with cleaning
steps applied to the latter, resulting in a 99,338 row, 13 column
dataset which, in addition, contains the longitude and latitude of the
borders of the countries and territories which we desire to plot.
<code>region</code>, <code>subregion</code>, <code>group</code> and
<code>order</code> are used to identify the country borders.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">world_map</span><span class="op">)</span></span>
<span><span class="co">#&gt;   alpha_3_code alpha_2_code.x numeric      long      lat group order region</span></span>
<span><span class="co">#&gt; 1          ABW             AW     533 -69.89912 12.45200     1     1  Aruba</span></span>
<span><span class="co">#&gt; 2          ABW             AW     533 -69.89571 12.42300     1     2  Aruba</span></span>
<span><span class="co">#&gt; 3          ABW             AW     533 -69.94219 12.43853     1     3  Aruba</span></span>
<span><span class="co">#&gt; 4          ABW             AW     533 -70.00415 12.50049     1     4  Aruba</span></span>
<span><span class="co">#&gt; 5          ABW             AW     533 -70.06612 12.54697     1     5  Aruba</span></span>
<span><span class="co">#&gt; 6          ABW             AW     533 -70.05088 12.59707     1     6  Aruba</span></span>
<span><span class="co">#&gt;   subregion country.x economy income_group redcap_number country.y</span></span>
<span><span class="co">#&gt; 1      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt; 2      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt; 3      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt; 4      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt; 5      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt; 6      &lt;NA&gt;     Aruba   Aruba  High income            13     Aruba</span></span>
<span><span class="co">#&gt;   alpha_2_code.y centroid_long centroid_lat</span></span>
<span><span class="co">#&gt; 1             AW     -69.97564     12.51563</span></span>
<span><span class="co">#&gt; 2             AW     -69.97564     12.51563</span></span>
<span><span class="co">#&gt; 3             AW     -69.97564     12.51563</span></span>
<span><span class="co">#&gt; 4             AW     -69.97564     12.51563</span></span>
<span><span class="co">#&gt; 5             AW     -69.97564     12.51563</span></span>
<span><span class="co">#&gt; 6             AW     -69.97564     12.51563</span></span></code></pre></div>
<p>These datasets are also stored as csv files in the GitHub for
use.</p>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<p>As well as the data, we introduce some functions which can assist
making the maps, so that regular users and beginners alike can utilise
this tool. We’ll show <code><a href="../reference/create_participant_map.html">create_participant_map()</a></code> which allows
the user to make a choropleth for the number of participants per country
in a dataset, there is also <code><a href="../reference/create_studies_map.html">create_studies_map()</a></code> which is
very similar but the default legend refers to studies as opposed to
particiapnts, the rest of the parameters work the same way.</p>
<p>Your dataset will need to include what country the participant or
study (or other entity) is from, in the 3 digit ISO code format. The
function will group the data by the country and then summarise the data
in a <code>ggplot</code> using the <code>geom_polygon()</code> function.
If your data does not have the 3 digit ISO code,
<code>left_join()</code> your dataset with <code>world_income</code>
with the key being the country code or name you do have, then you’ll
have the <code>alpha_3_code</code> in your data and use this as the
<code>country_col</code> below.</p>
<div class="section level4">
<h4 id="create-synthetic-data-for-example">Create Synthetic Data for Example<a class="anchor" aria-label="anchor" href="#create-synthetic-data-for-example"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># for reproducibility</span></span>
<span></span>
<span><span class="va">countries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">world_income</span><span class="op">$</span><span class="va">alpha_3_code</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">countries</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">probabilities</span> <span class="op">&lt;-</span> <span class="va">probabilities</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">probabilities</span><span class="op">)</span></span>
<span></span>
<span><span class="va">country_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>COUNTRY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">countries</span>, <span class="fl">10000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="va">probabilities</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="using-the-functions">Using the Functions<a class="anchor" aria-label="anchor" href="#using-the-functions"></a>
</h4>
<p>Now we can take our data, <code>country_data</code>, indicate the
name of the column where the three digit ISO country code exists
(<code>country_col</code>) and run the command.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>This visualises the example data, along with legend and the total
number, n, of participants. Although, perhaps you do not want n to be
displayed and you’ll note that Antarctica is not present, using extra
parameters we can change that.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>                       include_n   <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       include_ATA <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The title and subtitle can be added to the plot to provide more
information about your graphic, and the legend title can be changed, or
removed by leaving the option blank.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>                       title       <span class="op">=</span> <span class="st">"Number of Participants in Studies across Countries"</span>,</span>
<span>                       subtitle    <span class="op">=</span> <span class="st">"Data from studies registered between 2000 - 2024"</span>,</span>
<span>                       legend      <span class="op">=</span> <span class="st">"Some Legend"</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Blue not your colour? No problem, customise the colour of the
countries, borders, text and background easily.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>                       colour_high <span class="op">=</span> <span class="st">"#FF3C38"</span>,</span>
<span>                       colour_low  <span class="op">=</span> <span class="st">"#FFCFCF"</span>,</span>
<span>                       colour_default <span class="op">=</span> <span class="st">"#F0DFEE"</span>,</span>
<span>                       colour_borders <span class="op">=</span> <span class="st">"#20A39E"</span>,</span>
<span>                       colour_background <span class="op">=</span> <span class="st">"#DAEDBD"</span>,</span>
<span>                       colour_text <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<p>You can change the scale breaks on the legend using
<code>scale_breaks</code> and log transform the scale using
<code>log_scale</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>                       scale_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">180</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/create_participant_map.html">create_participant_map</a></span><span class="op">(</span>data        <span class="op">=</span> <span class="va">country_data</span>,</span>
<span>                       country_col <span class="op">=</span> <span class="st">"COUNTRY"</span>,</span>
<span>                       log_scale   <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       legend      <span class="op">=</span> <span class="st">"Log Scale of Participants"</span><span class="op">)</span></span></code></pre></div>
<p><img src="worlddatr_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;"></p>
<p>This does not intend to be the only solution and we encourage you to
use the code in the GitHub to develop graphs more specific to your
needs, this hopes to provide some inspiration, without spending hours to
see if it works. If you have suggestions, issues or want to contribute
to the package contact us or see more on the GitHub page.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rhys Peploe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
